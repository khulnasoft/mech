.. image:: https://github.com/khulnasoft/khulnasoft.github.io/blob/main/img/externally_linked/logo.png?raw=true#gh-light-mode-only
   :width: 100%
   :class: only-light

.. image:: https://github.com/khulnasoft/khulnasoft.github.io/blob/main/img/externally_linked/logo_dark.png?raw=true#gh-dark-mode-only
   :width: 100%
   :class: only-dark

.. raw:: html

    <br/>
    <a href="https://pypi.org/project/aikit-mech/0.0.1.post0/">
        <img class="dark-light" style="float: left; padding-right: 4px; padding-bottom: 4px;" src="https://badge.fury.io/py/aikit-mech.svg">
    </a>
    <a href="https://github.com/khulnasoft/mech/actions?query=workflow%3Adocs">
        <img class="dark-light" style="float: left; padding-right: 4px; padding-bottom: 4px;" src="https://github.com/khulnasoft/mech/actions/workflows/docs.yml/badge.svg">
    </a>
    <a href="https://github.com/khulnasoft/mech/actions?query=workflow%3Anightly-tests">
        <img class="dark-light" style="float: left; padding-right: 4px; padding-bottom: 4px;" src="https://github.com/khulnasoft/mech/actions/workflows/nightly-tests.yml/badge.svg">
    </a>
    <a href="https://discord.gg/G4aR9Q7DTN">
        <img class="dark-light" style="float: left; padding-right: 4px; padding-bottom: 4px;" src="https://img.shields.io/discord/799879767196958751?color=blue&label=%20&logo=discord&logoColor=white">
    </a>
    <br clear="all" />

**Mechanics functions with end-to-end support for machine learning developers, written in Aikit.**

.. raw:: html

    <div style="display: block;" align="center">
        <img class="dark-light" width="6%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/empty.png">
        <a href="https://jax.readthedocs.io">
            <img class="dark-light" width="13%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/jax_logo.png">
        </a>
        <img class="dark-light" width="12%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/empty.png">
        <a href="https://www.tensorflow.org">
            <img class="dark-light" width="13%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/tensorflow_logo.png">
        </a>
        <img class="dark-light" width="12%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/empty.png">
        <a href="https://pytorch.org">
            <img class="dark-light" width="13%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/pytorch_logo.png">
        </a>
        <img class="dark-light" width="12%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/empty.png">
        <a href="https://numpy.org">
            <img class="dark-light" width="13%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/numpy_logo.png">
        </a>
        <img class="dark-light" width="6%" style="float: left;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/supported/empty.png">
    </div>

Contents
--------

* `Overview`_
* `Run Through`_
* `Interactive Demos`_
* `Get Involved`_

Overview
--------

.. _docs: https://unify.ai/docs/mech/

**What is Aikit Mechanics?**

Aikit mechanics provides functions for conversions of orientation, pose, and positional representations,
as well as frame-of-reference transformations, and other more applied functions. Check out the docs_ for more info!

The library is built on top of the Aikit machine learning framework.
This means all functions simultaneously support:
Jax, Tensorflow, PyTorch, MXNet, and Numpy.

**Aikit Libraries**

There are a host of derived libraries written in Aikit, in the areas of mechanics, 3D vision, robotics, gym environments,
neural memory, pre-trained models + implementations, and builder tools with trainers, data loaders and more. Click on the icons below to learn more!

.. raw:: html

    <div style="display: block;">
        <a href="https://github.com/khulnasoft/mech">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_mech_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_mech.png">
            </picture>
        </a>
        <a href="https://github.com/khulnasoft/vision">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_vision_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_vision.png">
            </picture>
        </a>
        <a href="https://github.com/khulnasoft/robot">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_robot_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_robot.png">
            </picture>
        </a>
        <a href="https://github.com/khulnasoft/gym">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_gym_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_gym.png">
            </picture>
        </a>

        <br clear="all" />

        <a href="https://pypi.org/project/aikit-mech/0.0.1.post0/">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://badge.fury.io/py/aikit-mech.svg">
        </a>
        <a href="https://pypi.org/project/aikit-vision/0.0.1.post0/">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://badge.fury.io/py/aikit-vision.svg">
        </a>
        <a href="https://pypi.org/project/aikit-robot/0.0.1.post0/">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://badge.fury.io/py/aikit-robot.svg">
        </a>
        <a href="https://pypi.org/project/aikit-gym">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;"width="15%" style="float: left; margin: 0% 5%;" src="https://badge.fury.io/py/aikit-gym.svg">
        </a>

        <br clear="all" />

        <a href="https://github.com/khulnasoft/mech/actions?query=workflow%3Anightly-tests">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;"src="https://github.com/khulnasoft/mech/actions/workflows/nightly-tests.yml/badge.svg">
        </a>
        <a href="https://github.com/khulnasoft/vision/actions?query=workflow%3Anightly-tests">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://github.com/khulnasoft/vision/actions/workflows/nightly-tests.yml/badge.svg">
        </a>
        <a href="https://github.com/khulnasoft/robot/actions?query=workflow%3Anightly-tests">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://github.com/khulnasoft/robot/actions/workflows/nightly-tests.yml/badge.svg">
        </a>
        <a href="https://github.com/khulnasoft/gym/actions?query=workflow%3Anightly-tests">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://github.com/khulnasoft/gym/actions/workflows/nightly-tests.yml/badge.svg">
        </a>

        <br clear="all" />

        <a href="https://github.com/khulnasoft/memory">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_memory_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_memory.png">
            </picture>
        </a>
        <a href="https://github.com/khulnasoft/builder">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_builder_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_builder.png">
            </picture>
        </a>
        <a href="https://github.com/khulnasoft/models">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_models_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_models.png">
            </picture>
        </a>
        <a href="https://github.com/khulnasoft/ecosystem">
            <picture>
                <source class="dark-light" width="15%" style="float: left; margin: 0% 5%;" media="(prefers-color-scheme: dark)" srcset="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_ecosystem_dark.png">
                <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://raw.githubusercontent.com/khulnasoft/khulnasoft.github.io/main/img/externally_linked/logos/aikit_ecosystem.png">
            </picture>
        </a>

        <br clear="all" />

        <a href="https://pypi.org/project/aikit-memory/0.0.1.post0/">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://badge.fury.io/py/aikit-memory.svg">
        </a>
        <a href="https://pypi.org/project/aikit-builder/0.0.1.post0/">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://badge.fury.io/py/aikit-builder.svg">
        </a>
        <a href="https://pypi.org/project/aikit-models">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://badge.fury.io/py/aikit-models.svg">
        </a>
        <a href="https://github.com/khulnasoft/ecosystem/actions?query=workflow%3Adocs">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://github.com/khulnasoft/ecosystem/actions/workflows/docs.yml/badge.svg">
        </a>

        <br clear="all" />

        <a href="https://github.com/khulnasoft/memory/actions?query=workflow%3Anightly-tests">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://github.com/khulnasoft/memory/actions/workflows/nightly-tests.yml/badge.svg">
        </a>
        <a href="https://github.com/khulnasoft/builder/actions?query=workflow%3Anightly-tests">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://github.com/khulnasoft/builder/actions/workflows/nightly-tests.yml/badge.svg">
        </a>
        <a href="https://github.com/khulnasoft/models/actions?query=workflow%3Anightly-tests">
            <img class="dark-light" width="15%" style="float: left; margin: 0% 5%;" src="https://github.com/khulnasoft/models/actions/workflows/nightly-tests.yml/badge.svg">
        </a>

        <br clear="all" />

    </div>
    <br clear="all" />


**Quick Start**

Aikit mechanics can be installed like so: ``pip install aikit-mech==0.0.1.post0``

.. _demos: https://github.com/khulnasoft/mech/tree/main/aikit_mech_demos
.. _interactive: https://github.com/khulnasoft/mech/tree/main/aikit_mech_demos/interactive

To quickly see the different aspects of the library, we suggest you check out the demos_!
We suggest you start by running the script ``run_through.py``,
and read the "Run Through" section below which explains this script.

For more interactive demos, we suggest you run either
``target_facing_rotation_matrix.py`` or ``polar_to_cartesian_coords.py`` in the interactive_ demos folder.

Run Through
-----------

We run through some of the different parts of the library via a simple ongoing example script.
The full script is available in the demos_ folder, as file ``run_through.py``.
First, we select a random backend framework to use for the examples, from the options
``aikit.jax``, ``aikit.tensorflow``, ``aikit.torch``, ``aikit.mxnd`` or ``aikit.numpy``,
and use this to set the aikit backend framework.

.. code-block:: python

    import aikit
    aikit.set_backend(aikit.choose_random_backend())

**Orientation Module**

The orientation module is the most comprehensive, with conversions to and from all euler conventions, quaternions,
rotation matrices, rotation vectors, and axis-angle representations.

A few of the orientation functions are outlined below.

.. code-block:: python

    # rotation representations

    # 3
    rot_vec = aikit.array([0., 1., 0.])

    # 3 x 3
    rot_mat = aikit_mech.rot_vec_to_rot_mat(rot_vec)

    # 3
    euler_angles = aikit_mech.rot_mat_to_euler(rot_mat, 'zyx')

    # 4
    quat = aikit_mech.euler_to_quaternion(euler_angles)

    # 3, 1
    axis, angle = aikit_mech.quaternion_to_axis_and_angle(quat)

    # 3
    rot_vec_again = axis * angle

**Pose Module**

The pose representations mirror the orientation representations, with the addition of 3 values to
represent the cartesian position. Again, we give some examples below.

.. code-block:: python

    # pose representations

    # 3
    position = aikit.ones_like(rot_vec)

    # 6
    rot_vec_pose = aikit.concat((position, rot_vec), axis=0)

    # 3 x 4
    mat_pose = aikit_mech.rot_vec_pose_to_mat_pose(rot_vec_pose)

    # 6
    euler_pose = aikit_mech.mat_pose_to_euler_pose(mat_pose)

    # 7
    quat_pose = aikit_mech.euler_pose_to_quaternion_pose(euler_pose)

    # 6
    rot_vec_pose_again = aikit_mech.quaternion_pose_to_rot_vec_pose(quat_pose)

**Position Module**

The position module includes functions for converting between positional representations,
such as cartesian and polar conventions,
and for applying frame-of-reference transformations to cartesian co-ordinates.

We give some examples for conversion of positional representation below.

.. code-block:: python

    # conversions of positional representation

    # 3
    cartesian_coord = aikit.random_uniform(low=0., high=1., shape=(3,))

    # 3
    polar_coord = aikit_mech.cartesian_to_polar_coords(
        cartesian_coord)

    # 3
    cartesian_coord_again = aikit_mech.polar_to_cartesian_coords(
        polar_coord)

Assuming cartesian form, we give an example of a frame-of-reference transformations below.

.. code-block:: python

    # cartesian co-ordinate frame-of-reference transformations

    # 3 x 4
    trans_mat = aikit.random_uniform(low=0., high=1., shape=(3, 4))

    # 4
    cartesian_coord_homo = aikit_mech.make_coordinates_homogeneous(
        cartesian_coord)

    # 3
    trans_cartesian_coord = aikit.matmul(
        trans_mat, aikit.expand_dims(cartesian_coord_homo, axis=-1))[:, 0]

    # 4
    trans_cartesian_coord_homo = aikit_mech.make_coordinates_homogeneous(
        trans_cartesian_coord)

    # 4 x 4
    trans_mat_homo = aikit_mech.make_transformation_homogeneous(
        trans_mat)

    # 3 x 4
    inv_trans_mat = aikit.inv(trans_mat_homo)[0:3]

    # 3
    cartesian_coord_again = aikit.matmul(
        inv_trans_mat, aikit.expand_dims(trans_cartesian_coord_homo, axis=-1))[:, 0]

Interactive Demos
-----------------

In addition to the run through above, we provide two further demo scripts,
which are more visual and interactive, and are each built around a particular function.

Rather than presenting the code here, we show visualizations of the demos.
The scripts for these demos can be found in the interactive_ demos folder.

**Target Facing Rotation Matrix**

The first demo uses the method ``aikit_mech.target_facing_rotation_matrix`` to dynamically
track a moving target plant pot with a camera, as shown below:

.. raw:: html

    <p align="center">
        <img width="75%" style="display: block;" src='https://github.com/khulnasoft/khulnasoft.github.io/blob/main/img/externally_linked/aikit_mech/demo_a.gif?raw=true'>
    </p>

**Polar to Cartesian Co-ordinates**

The second demo uses the method ``aikit_mech.polar_to_cartesian_coords`` to convert a polar depth image
acquired from an omni-directional camera into cartesian co-ordinates,
enabling the surrounding geometry to be represented as a point cloud, for interactive visualization.

.. raw:: html

    <p align="center">
        <img width="75%" style="display: block;" src='https://github.com/khulnasoft/khulnasoft.github.io/blob/main/img/externally_linked/aikit_mech/demo_b.gif?raw=true'>
    </p>

Get Involved
------------

We hope the functions in this library are useful to a wide range of machine learning developers.
However, there are many more areas of mechanics which could be covered by this library.

If there are any particular mechanics functions you feel are missing,
and your needs are not met by the functions currently on offer,
then we are very happy to accept pull requests!

We look forward to working with the community on expanding and improving the Aikit mechanics library.

Citation
--------

::

    @article{lenton2021aikit,
      title={Aikit: Templated deep learning for inter-framework portability},
      author={Lenton, Daniel and Pardo, Fabio and Falck, Fabian and James, Stephen and Clark, Ronald},
      journal={arXiv preprint arXiv:2102.02886},
      year={2021}
    }
